{"version":3,"sources":["webpack://pcbStackupCore/webpack/bootstrap","webpack://pcbStackupCore/../whats-that-gerber/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/viewbox/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/xtend/immutable.js","webpack://pcbStackupCore/../whats-that-gerber/lib/constants.js","webpack://pcbStackupCore/../whats-that-gerber/lib/flat-map.js","webpack://pcbStackupCore/../whats-that-gerber/lib/layer-types.js","webpack://pcbStackupCore/./lib/board-color.js","webpack://pcbStackupCore/./index.js","webpack://pcbStackupCore/../whats-that-gerber/lib/get-common-cad.js","webpack://pcbStackupCore/../whats-that-gerber/lib/get-matches.js","webpack://pcbStackupCore/../whats-that-gerber/lib/matchers.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/color-string/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/color-name/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/simple-swizzle/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/simple-swizzle/node_modules/is-arrayish/index.js","webpack://pcbStackupCore/./lib/parse-options.js","webpack://pcbStackupCore/../xml-id/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/xml-element-string/index.js","webpack://pcbStackupCore/C:/xampp/htdocs/PROYECTOS/tracespace/tracespace/node_modules/escape-html/index.js","webpack://pcbStackupCore/./lib/sort-layers.js","webpack://pcbStackupCore/./lib/stack-layers.js","webpack://pcbStackupCore/./lib/_gather-layers.js","webpack://pcbStackupCore/./lib/wrap-layer.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","constants","flatMap","getCommonCad","getMatches","layerTypes","filenames","matches","commonCad","reduce","result","filename","match","cad","filenameMatches","filter","find","_selectMatch","type","side","validate","target","valid","some","layer","getAllLayers","map","keys","forEach","constantName","add","box","addend","length","xMin","Math","min","yMin","max","scale","component","rect","x","y","width","height","asString","join","arguments","source","TYPE_COPPER","TYPE_SOLDERMASK","TYPE_SILKSCREEN","TYPE_SOLDERPASTE","TYPE_DRILL","TYPE_OUTLINE","TYPE_DRAWING","SIDE_TOP","SIDE_BOTTOM","SIDE_INNER","SIDE_ALL","_CAD_KICAD","_CAD_ALTIUM","_CAD_ALLEGRO","_CAD_EAGLE","_CAD_EAGLE_LEGACY","_CAD_EAGLE_OSHPARK","_CAD_EAGLE_PCBNG","_CAD_GEDA_PCB","_CAD_ORCAD","_CAD_DIPTRACE","collection","iterator","element","concat","matchers","ext","colorString","LAYER_IDS","DEFAULTS","fr4","cu","cf","sm","ss","sp","out","getColor","overrides","color","id","getStyleElement","prefix","parsedColor","css","components","slice","alpha","model","to","hex","toLowerCase","colorToCssString","extend","wtg","vb","boardColor","parseOptions","sortLayers","stackLayers","SIDES","BASE_ATTRIBUTES","version","xmlns","getGroupAttributes","mechMaskId","outClipId","attr","mask","xTranslation","transform","layers","inputOpts","options","sorted","attributes","useOutline","createElement","stacks","drills","outline","stack","index","style","units","defs","defsNode","layerNode","getLayerAttributes","sideAttributes","viewBox","svg","cadCount","counts","maxAndName","count","matcher","test","Boolean","RegExp","colorNames","swizzle","reverseNames","cs","clamp","num","hexDouble","str","toString","toUpperCase","string","val","substring","hsl","hwb","rgb","hexAlpha","i2","parseInt","round","parseFloat","isNaN","rgba","percent","g","b","hsla","hwba","a","keyword","isArrayish","Array","args","results","len","arg","push","wrap","fn","obj","isArray","splice","Function","getOwnPropertyDescriptor","constructor","xid","xmlElementString","input","ensure","START_CHAR","CHAR","REPLACE_RE","random","_getRandomString","sanitize","replace","alphabet","abLength","floor","maybeId","escapeHtml","tag","children","matchHtmlRegExp","escape","exec","html","lastIndex","charCodeAt","acceptLayer","converter","assignLayer","top","bottom","viewbox","gatherLayers","findLayerId","useLayer","className","fill","stroke","class","createRect","classPrefix","idPrefix","layerProps","layerIds","drillIds","unshift","group","mechMask","cuLayerId","smLayerId","ssLayerId","spLayerId","outLayerId","outlineId","cfMaskId","cfMaskGroup","smMaskId","smMaskGroup","smGroupAttr","smGroupShape","wrapLayer","getScale","layerUnits","unitsCount","in","mm","allLayers","drillCount","getUniqueId","externalId","layerBox","wrapConverterLayer"],"mappings":"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","file":"pcb-stackup-core.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","'use strict'\r\n\r\nvar constants = require('./lib/constants')\r\nvar flatMap = require('./lib/flat-map')\r\nvar getCommonCad = require('./lib/get-common-cad')\r\nvar getMatches = require('./lib/get-matches')\r\nvar layerTypes = require('./lib/layer-types')\r\n\r\nmodule.exports = whatsThatGerber\r\nmodule.exports.validate = validate\r\nmodule.exports.getAllLayers = getAllLayers\r\n\r\nObject.keys(constants).forEach(function(constantName) {\r\n  module.exports[constantName] = constants[constantName]\r\n})\r\n\r\nfunction whatsThatGerber(filenames) {\r\n  if (typeof filenames === 'string') filenames = [filenames]\r\n\r\n  var matches = flatMap(filenames, getMatches)\r\n  var commonCad = getCommonCad(matches)\r\n\r\n  return filenames.reduce(function(result, filename) {\r\n    var match = _selectMatch(matches, filename, commonCad)\r\n\r\n    result[filename] = match\r\n      ? {type: match.type, side: match.side}\r\n      : {type: null, side: null}\r\n\r\n    return result\r\n  }, {})\r\n}\r\n\r\nfunction getAllLayers() {\r\n  return layerTypes\r\n    .map(function(layer) {\r\n      return {type: layer.type, side: layer.side}\r\n    })\r\n    .filter(function(layer) {\r\n      return layer.type !== null\r\n    })\r\n}\r\n\r\nfunction validate(target) {\r\n  return {\r\n    valid: layerTypes.some(_validateLayer),\r\n    side: layerTypes.some(_validateSide) ? target.side : null,\r\n    type: layerTypes.some(_validateType) ? target.type : null,\r\n  }\r\n\r\n  function _validateLayer(layer) {\r\n    return layer.side === target.side && layer.type === target.type\r\n  }\r\n\r\n  function _validateSide(layer) {\r\n    return layer.side === target.side\r\n  }\r\n\r\n  function _validateType(layer) {\r\n    return layer.type === target.type\r\n  }\r\n}\r\n\r\nfunction _selectMatch(matches, filename, cad) {\r\n  var filenameMatches = matches.filter(function(match) {\r\n    return match.filename === filename\r\n  })\r\n\r\n  var result = filenameMatches.find(function(match) {\r\n    return match.cad === cad\r\n  })\r\n\r\n  return result || filenameMatches[0] || null\r\n}\r\n","// viewbox helper library\n'use strict'\n\nmodule.exports = {\n  create: function createViewbox() {\n    return []\n  },\n\n  add: function addViewboxes(box, addend) {\n    if (!box.length) {\n      return addend\n    }\n\n    if (!addend.length) {\n      return box\n    }\n\n    var xMin = Math.min(box[0], addend[0])\n    var yMin = Math.min(box[1], addend[1])\n    var xMax = Math.max((box[0] + box[2]), (addend[0] + addend[2]))\n    var yMax = Math.max((box[1] + box[3]), (addend[1] + addend[3]))\n\n    return [xMin, yMin, (xMax - xMin), (yMax - yMin)]\n  },\n\n  scale: function scaleViewboxes(box, scale) {\n    return box.map(function(component) {\n      return component * scale\n    })\n  },\n\n  rect: function viewboxRect(box) {\n    box = box && box.length\n      ? box\n      : [0, 0, 0, 0]\n\n    return {\n      x: box[0],\n      y: box[1],\n      width: box[2],\n      height: box[3]\n    }\n  },\n\n  asString: function(box) {\n    box = box && box.length\n      ? box\n      : [0, 0, 0, 0]\n\n    return box.join(' ')\n  }\n}\n","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","'use strict'\r\n\r\nmodule.exports = {\r\n  // layer types\r\n  TYPE_COPPER: 'copper',\r\n  TYPE_SOLDERMASK: 'soldermask',\r\n  TYPE_SILKSCREEN: 'silkscreen',\r\n  TYPE_SOLDERPASTE: 'solderpaste',\r\n  TYPE_DRILL: 'drill',\r\n  TYPE_OUTLINE: 'outline',\r\n  TYPE_DRAWING: 'drawing',\r\n\r\n  // board sides\r\n  SIDE_TOP: 'top',\r\n  SIDE_BOTTOM: 'bottom',\r\n  SIDE_INNER: 'inner',\r\n  SIDE_ALL: 'all',\r\n\r\n  // cad packages\r\n  // internal use only, for now\r\n  _CAD_KICAD: 'kicad',\r\n  _CAD_ALTIUM: 'altium',\r\n  _CAD_ALLEGRO: 'allegro',\r\n  _CAD_EAGLE: 'eagle',\r\n  _CAD_EAGLE_LEGACY: 'eagle-legacy',\r\n  _CAD_EAGLE_OSHPARK: 'eagle-oshpark',\r\n  _CAD_EAGLE_PCBNG: 'eagle-pcbng',\r\n  _CAD_GEDA_PCB: 'geda-pcb',\r\n  _CAD_ORCAD: 'orcad',\r\n  _CAD_DIPTRACE: 'diptrace',\r\n}\r\n","'use strict'\r\n\r\nmodule.exports = function flatMap(collection, iterator) {\r\n  return collection.reduce(function iterate(result, element) {\r\n    return result.concat(iterator(element))\r\n  }, [])\r\n}\r\n","'use strict'\r\n\r\nvar c = require('./constants')\r\n\r\nmodule.exports = [\r\n  // high-priority blacklist\r\n  {\r\n    type: null,\r\n    side: null,\r\n    matchers: [\r\n      // eagle gerber generation metadata\r\n      {\r\n        ext: 'gpi',\r\n        cad: [\r\n          c._CAD_EAGLE,\r\n          c._CAD_EAGLE_LEGACY,\r\n          c._CAD_EAGLE_OSHPARK,\r\n          c._CAD_EAGLE_PCBNG,\r\n        ],\r\n      },\r\n      // eagle drill generation metadata\r\n      {\r\n        ext: 'dri',\r\n        cad: [\r\n          c._CAD_EAGLE,\r\n          c._CAD_EAGLE_LEGACY,\r\n          c._CAD_EAGLE_OSHPARK,\r\n          c._CAD_EAGLE_PCBNG,\r\n        ],\r\n      },\r\n      // general data/BOM files\r\n      {ext: 'csv', cad: null},\r\n      // pick-n-place BOMs\r\n      {match: /pnp_bom/, cad: c._CAD_EAGLE_PCBNG},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_COPPER,\r\n    side: c.SIDE_TOP,\r\n    matchers: [\r\n      {ext: 'cmp', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'top', cad: [c._CAD_EAGLE_LEGACY, c._CAD_ORCAD]},\r\n      {ext: 'gtl', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'toplayer\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /top\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /f[._]cu/, cad: c._CAD_KICAD},\r\n      {match: /copper_top/, cad: c._CAD_EAGLE},\r\n      {match: /top_copper/, cad: c._CAD_EAGLE_PCBNG},\r\n      {match: /top copper/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_SOLDERMASK,\r\n    side: c.SIDE_TOP,\r\n    matchers: [\r\n      {ext: 'stc', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'tsm', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gts', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'smt', cad: c._CAD_ORCAD},\r\n      {ext: 'topsoldermask\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /topmask\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /f[._]mask/, cad: c._CAD_KICAD},\r\n      {match: /soldermask_top/, cad: c._CAD_EAGLE},\r\n      {match: /top_mask/, cad: c._CAD_EAGLE_PCBNG},\r\n      {match: /top solder resist/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_SILKSCREEN,\r\n    side: c.SIDE_TOP,\r\n    matchers: [\r\n      {ext: 'plc', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'tsk', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gto', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'sst', cad: c._CAD_ORCAD},\r\n      {ext: 'topsilkscreen\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /topsilk\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /f[._]silks/, cad: c._CAD_KICAD},\r\n      {match: /silkscreen_top/, cad: c._CAD_EAGLE},\r\n      {match: /top_silk/, cad: c._CAD_EAGLE_PCBNG},\r\n      {match: /top silk screen/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_SOLDERPASTE,\r\n    side: c.SIDE_TOP,\r\n    matchers: [\r\n      {ext: 'crc', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'tsp', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gtp', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'spt', cad: c._CAD_ORCAD},\r\n      {ext: 'tcream\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /toppaste\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /f[._]paste/, cad: c._CAD_KICAD},\r\n      {match: /solderpaste_top/, cad: c._CAD_EAGLE},\r\n      {match: /top_paste/, cad: c._CAD_EAGLE_PCBNG},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_COPPER,\r\n    side: c.SIDE_BOTTOM,\r\n    matchers: [\r\n      {ext: 'sol', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'bot', cad: [c._CAD_EAGLE_LEGACY, c._CAD_ORCAD]},\r\n      {ext: 'gbl', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'bottomlayer\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /bottom\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /b[._]cu/, cad: c._CAD_KICAD},\r\n      {match: /copper_bottom/, cad: c._CAD_EAGLE},\r\n      {match: /bottom_copper/, cad: c._CAD_EAGLE_PCBNG},\r\n      {match: /bottom copper/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_SOLDERMASK,\r\n    side: c.SIDE_BOTTOM,\r\n    matchers: [\r\n      {ext: 'sts', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'bsm', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gbs', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'smb', cad: c._CAD_ORCAD},\r\n      {ext: 'bottomsoldermask\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /bottommask\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /b[._]mask/, cad: c._CAD_KICAD},\r\n      {match: /soldermask_bottom/, cad: c._CAD_EAGLE},\r\n      {match: /bottom_mask/, cad: c._CAD_EAGLE_PCBNG},\r\n      {match: /bottom solder resist/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_SILKSCREEN,\r\n    side: c.SIDE_BOTTOM,\r\n    matchers: [\r\n      {ext: 'pls', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'bsk', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gbo', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'ssb', cad: c._CAD_ORCAD},\r\n      {ext: 'bottomsilkscreen\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /bottomsilk\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /b[._]silks/, cad: c._CAD_KICAD},\r\n      {match: /silkscreen_bottom/, cad: c._CAD_EAGLE},\r\n      {match: /bottom_silk/, cad: c._CAD_EAGLE_PCBNG},\r\n      {match: /bottom silk screen/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_SOLDERPASTE,\r\n    side: c.SIDE_BOTTOM,\r\n    matchers: [\r\n      {ext: 'crs', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'bsp', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gbp', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'spb', cad: c._CAD_ORCAD},\r\n      {ext: 'bcream\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /bottompaste\\.\\w+$/, cad: [c._CAD_GEDA_PCB, c._CAD_DIPTRACE]},\r\n      {match: /b[._]paste/, cad: c._CAD_KICAD},\r\n      {match: /solderpaste_bottom/, cad: c._CAD_EAGLE},\r\n      {match: /bottom_paste/, cad: c._CAD_EAGLE_PCBNG},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_COPPER,\r\n    side: c.SIDE_INNER,\r\n    matchers: [\r\n      {ext: 'ly\\\\d+', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gp?\\\\d+', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'in\\\\d+', cad: c._CAD_ORCAD},\r\n      {ext: 'internalplane\\\\d+\\\\.ger', cad: c._CAD_EAGLE_OSHPARK},\r\n      {match: /in(?:ner)?\\d+[._]cu/, cad: c._CAD_KICAD},\r\n      {match: /inner/, cad: c._CAD_DIPTRACE},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_OUTLINE,\r\n    side: c.SIDE_ALL,\r\n    matchers: [\r\n      {ext: 'dim', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'mil', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gml', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'gm\\\\d+', cad: [c._CAD_KICAD, c._CAD_ALTIUM]},\r\n      {ext: 'gko', cad: c._CAD_ALTIUM},\r\n      {ext: 'fab', cad: c._CAD_ORCAD},\r\n      {ext: 'drd', cad: c._CAD_ORCAD},\r\n      {match: /outline/, cad: [c._CAD_GEDA_PCB, c._CAD_EAGLE_PCBNG]},\r\n      {match: /boardoutline/, cad: [c._CAD_EAGLE_OSHPARK, c._CAD_DIPTRACE]},\r\n      {match: /edge[._]cuts/, cad: c._CAD_KICAD},\r\n      {match: /profile/, cad: c._CAD_EAGLE},\r\n      {match: /mechanical \\d+/, cad: null},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_DRILL,\r\n    side: c.SIDE_ALL,\r\n    matchers: [\r\n      {ext: 'txt', cad: [c._CAD_EAGLE_LEGACY, c._CAD_ALTIUM]},\r\n      {\r\n        ext: 'xln',\r\n        cad: [c._CAD_EAGLE, c._CAD_EAGLE_LEGACY, c._CAD_EAGLE_OSHPARK],\r\n      },\r\n      {ext: 'exc', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'drd', cad: c._CAD_EAGLE_LEGACY},\r\n      {ext: 'drl', cad: [c._CAD_KICAD, c._CAD_DIPTRACE]},\r\n      {ext: 'tap', cad: c._CAD_ORCAD},\r\n      {ext: 'npt', cad: c._CAD_ORCAD},\r\n      {ext: 'plated-drill\\\\.cnc', cad: c._CAD_GEDA_PCB},\r\n      {match: /fab/, cad: c._CAD_GEDA_PCB},\r\n      {match: /npth/, cad: c._CAD_KICAD},\r\n      {match: '/drill/', cad: c._CAD_EAGLE_PCBNG},\r\n    ],\r\n  },\r\n  {\r\n    type: c.TYPE_DRAWING,\r\n    side: null,\r\n    matchers: [\r\n      {ext: 'pos', cad: c._CAD_KICAD},\r\n      {ext: 'art', cad: c._CAD_ALLEGRO},\r\n      {ext: 'gbr', cad: null},\r\n      {ext: 'gbx', cad: null},\r\n      {ext: 'ger', cad: null},\r\n      {ext: 'pho', cad: null},\r\n    ],\r\n  },\r\n]\r\n","// board color defaults and css generation\r\n'use strict'\r\n\r\nvar colorString = require('color-string')\r\n\r\nvar LAYER_IDS = ['fr4', 'cu', 'cf', 'sm', 'ss', 'sp', 'out']\r\n\r\nvar DEFAULTS = {\r\n  fr4: '#666666',\r\n  cu: '#cccccc',\r\n  cf: '#cc9933',\r\n  sm: '#004200bf',\r\n  ss: '#ffffff',\r\n  sp: '#999999',\r\n  out: '#000000',\r\n}\r\n\r\nfunction getColor(overrides) {\r\n  overrides = overrides || {}\r\n\r\n  return LAYER_IDS.reduce(function(color, id) {\r\n    color[id] = overrides[id] || DEFAULTS[id]\r\n    return color\r\n  }, {})\r\n}\r\n\r\nfunction getStyleElement(element, prefix, side, color) {\r\n  return element('style', {}, [\r\n    LAYER_IDS.map(function(id) {\r\n      var selector = '.' + prefix + id\r\n      var style = colorToCssString(color[id])\r\n      return selector + ' {' + style + '}'\r\n    }).join('\\n'),\r\n  ])\r\n}\r\n\r\nfunction colorToCssString(color) {\r\n  var parsedColor = colorString.get(color)\r\n\r\n  if (!parsedColor) return ''\r\n\r\n  var css = 'color: '\r\n  var components = parsedColor.value.slice(0, 3)\r\n  var alpha = parsedColor.value[3] != null ? parsedColor.value[3] : 1\r\n\r\n  if (parsedColor.model === 'rgb') {\r\n    css += colorString.to.hex(components).toLowerCase()\r\n  } else {\r\n    css += colorString.to[parsedColor.model](components).toLowerCase()\r\n  }\r\n\r\n  if (alpha !== 1) {\r\n    css += '; opacity: ' + alpha\r\n  }\r\n\r\n  return css + ';'\r\n}\r\n\r\nmodule.exports = {getColor: getColor, getStyleElement: getStyleElement}\r\n","// main pcb stackup function\r\n'use strict'\r\n\r\nvar extend = require('xtend')\r\nvar wtg = require('whats-that-gerber')\r\nvar vb = require('viewbox')\r\n\r\nvar boardColor = require('./lib/board-color')\r\nvar parseOptions = require('./lib/parse-options')\r\nvar sortLayers = require('./lib/sort-layers')\r\nvar stackLayers = require('./lib/stack-layers')\r\n\r\nvar SIDES = [wtg.SIDE_TOP, wtg.SIDE_BOTTOM]\r\n\r\nvar BASE_ATTRIBUTES = {\r\n  version: '1.1',\r\n  xmlns: 'http://www.w3.org/2000/svg',\r\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\r\n  'stroke-linecap': 'round',\r\n  'stroke-linejoin': 'round',\r\n  'stroke-width': 0,\r\n  'fill-rule': 'evenodd',\r\n  'clip-rule': 'evenodd',\r\n}\r\n\r\nmodule.exports = function pcbStackupCore(layers, inputOpts) {\r\n  var options = parseOptions(inputOpts)\r\n  var sorted = sortLayers(layers)\r\n\r\n  var id = options.id\r\n  var color = options.color\r\n  var attributes = options.attributes\r\n  var useOutline = options.useOutline\r\n  var element = options.createElement\r\n\r\n  var stacks = SIDES.map(function(side) {\r\n    return stackLayers(\r\n      element,\r\n      id,\r\n      side,\r\n      sorted[side],\r\n      sorted.drills,\r\n      sorted.outline,\r\n      useOutline\r\n    )\r\n  })\r\n\r\n  var box = stacks.reduce(function(result, stack) {\r\n    return vb.add(result, stack.box)\r\n  }, vb.create())\r\n\r\n  if (box.length !== 4) box = [0, 0, 0, 0]\r\n\r\n  return stacks.reduce(function(result, stack, index) {\r\n    var side = SIDES[index]\r\n    var style = boardColor.getStyleElement(element, id + '_', side, color)\r\n    var units = stack.units\r\n    var mechMaskId = stack.mechMaskId\r\n    var outClipId = stack.outClipId\r\n    var defs = [style].concat(stack.defs)\r\n    var layer = [\r\n      element(\r\n        'g',\r\n        getGroupAttributes(box, side, mechMaskId, outClipId),\r\n        stack.layer\r\n      ),\r\n    ]\r\n\r\n    var defsNode = element('defs', {}, defs)\r\n    var layerNode = element('g', getLayerAttributes(box), layer)\r\n    var sideAttributes = extend(\r\n      BASE_ATTRIBUTES,\r\n      {\r\n        id: id + '_' + side,\r\n        viewBox: vb.asString(box),\r\n        width: box[2] / 1000 + units,\r\n        height: box[3] / 1000 + units,\r\n      },\r\n      attributes\r\n    )\r\n\r\n    result[side] = {\r\n      svg: element('svg', sideAttributes, [defsNode, layerNode]),\r\n      attributes: sideAttributes,\r\n      defs: defs,\r\n      layer: layer,\r\n      viewBox: box,\r\n      width: box[2] / 1000,\r\n      height: box[3] / 1000,\r\n      units: units,\r\n    }\r\n\r\n    return result\r\n  }, options)\r\n}\r\n\r\nfunction getGroupAttributes(box, side, mechMaskId, outClipId) {\r\n  var attr = {mask: 'url(#' + mechMaskId + ')'}\r\n\r\n  if (outClipId) {\r\n    attr['clip-path'] = 'url(#' + outClipId + ')'\r\n  }\r\n\r\n  // flip the bottom render in the x\r\n  if (side === wtg.SIDE_BOTTOM) {\r\n    var xTranslation = 2 * box[0] + box[2]\r\n    attr.transform = 'translate(' + xTranslation + ',0) scale(-1,1)'\r\n  }\r\n\r\n  return attr\r\n}\r\n\r\nfunction getLayerAttributes(box) {\r\n  var yTranslation = 2 * box[1] + box[3]\r\n  return {transform: 'translate(0,' + yTranslation + ') scale(1,-1)'}\r\n}\r\n","'use strict'\r\n\r\nmodule.exports = function getCommonCad(matches) {\r\n  var cadCount = matches.reduce(function(counts, match) {\r\n    counts[match.cad] = counts[match.cad] + 1 || 1\r\n    return counts\r\n  }, {})\r\n\r\n  return Object.keys(cadCount).reduce(\r\n    function(maxAndName, name) {\r\n      var count = cadCount[name]\r\n      if (count > maxAndName.max) return {max: count, name: name}\r\n      return maxAndName\r\n    },\r\n    {max: 0, name: null}\r\n  ).name\r\n}\r\n","'use strict'\r\n\r\nvar extend = require('xtend')\r\n\r\nvar matchers = require('./matchers')\r\n\r\nmodule.exports = function getMatches(filename) {\r\n  return matchers.map(matcherToFileMatches).filter(Boolean)\r\n\r\n  function matcherToFileMatches(matcher) {\r\n    if (!matcher.match.test(filename)) return null\r\n    return extend(matcher, {filename: filename})\r\n  }\r\n}\r\n","'use strict'\r\n\r\nvar flatMap = require('./flat-map')\r\nvar layerTypes = require('./layer-types')\r\n\r\nmodule.exports = flatMap(layerTypes, layerTypeToMatchers)\r\n\r\nfunction layerTypeToMatchers(layer) {\r\n  return flatMap(layer.matchers, matcherToCadMatchers)\r\n\r\n  function matcherToCadMatchers(matcher) {\r\n    var match = matcher.ext\r\n      ? new RegExp('\\\\.' + matcher.ext + '$', 'i')\r\n      : new RegExp(matcher.match, 'i')\r\n\r\n    return [].concat(matcher.cad).map(mergeLayerWithCad)\r\n\r\n    function mergeLayerWithCad(cad) {\r\n      return {\r\n        type: layer.type,\r\n        side: layer.side,\r\n        match: match,\r\n        cad: cad,\r\n      }\r\n    }\r\n  }\r\n}\r\n","/* MIT license */\nvar colorNames = require('color-name');\nvar swizzle = require('simple-swizzle');\n\nvar reverseNames = {};\n\n// create a list of reverse color names\nfor (var name in colorNames) {\n\tif (colorNames.hasOwnProperty(name)) {\n\t\treverseNames[colorNames[name]] = name;\n\t}\n}\n\nvar cs = module.exports = {\n\tto: {},\n\tget: {}\n};\n\ncs.get = function (string) {\n\tvar prefix = string.substring(0, 3).toLowerCase();\n\tvar val;\n\tvar model;\n\tswitch (prefix) {\n\t\tcase 'hsl':\n\t\t\tval = cs.get.hsl(string);\n\t\t\tmodel = 'hsl';\n\t\t\tbreak;\n\t\tcase 'hwb':\n\t\t\tval = cs.get.hwb(string);\n\t\t\tmodel = 'hwb';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tval = cs.get.rgb(string);\n\t\t\tmodel = 'rgb';\n\t\t\tbreak;\n\t}\n\n\tif (!val) {\n\t\treturn null;\n\t}\n\n\treturn {model: model, value: val};\n};\n\ncs.get.rgb = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar abbr = /^#([a-f0-9]{3,4})$/i;\n\tvar hex = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i;\n\tvar rgba = /^rgba?\\(\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar per = /^rgba?\\(\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar keyword = /(\\D+)/;\n\n\tvar rgb = [0, 0, 0, 1];\n\tvar match;\n\tvar i;\n\tvar hexAlpha;\n\n\tif (match = string.match(hex)) {\n\t\thexAlpha = match[2];\n\t\tmatch = match[1];\n\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\t// https://jsperf.com/slice-vs-substr-vs-substring-methods-long-string/19\n\t\t\tvar i2 = i * 2;\n\t\t\trgb[i] = parseInt(match.slice(i2, i2 + 2), 16);\n\t\t}\n\n\t\tif (hexAlpha) {\n\t\t\trgb[3] = Math.round((parseInt(hexAlpha, 16) / 255) * 100) / 100;\n\t\t}\n\t} else if (match = string.match(abbr)) {\n\t\tmatch = match[1];\n\t\thexAlpha = match[3];\n\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = parseInt(match[i] + match[i], 16);\n\t\t}\n\n\t\tif (hexAlpha) {\n\t\t\trgb[3] = Math.round((parseInt(hexAlpha + hexAlpha, 16) / 255) * 100) / 100;\n\t\t}\n\t} else if (match = string.match(rgba)) {\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = parseInt(match[i + 1], 0);\n\t\t}\n\n\t\tif (match[4]) {\n\t\t\trgb[3] = parseFloat(match[4]);\n\t\t}\n\t} else if (match = string.match(per)) {\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = Math.round(parseFloat(match[i + 1]) * 2.55);\n\t\t}\n\n\t\tif (match[4]) {\n\t\t\trgb[3] = parseFloat(match[4]);\n\t\t}\n\t} else if (match = string.match(keyword)) {\n\t\tif (match[1] === 'transparent') {\n\t\t\treturn [0, 0, 0, 0];\n\t\t}\n\n\t\trgb = colorNames[match[1]];\n\n\t\tif (!rgb) {\n\t\t\treturn null;\n\t\t}\n\n\t\trgb[3] = 1;\n\n\t\treturn rgb;\n\t} else {\n\t\treturn null;\n\t}\n\n\tfor (i = 0; i < 3; i++) {\n\t\trgb[i] = clamp(rgb[i], 0, 255);\n\t}\n\trgb[3] = clamp(rgb[3], 0, 1);\n\n\treturn rgb;\n};\n\ncs.get.hsl = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar hsl = /^hsla?\\(\\s*([+-]?(?:\\d*\\.)?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar match = string.match(hsl);\n\n\tif (match) {\n\t\tvar alpha = parseFloat(match[4]);\n\t\tvar h = (parseFloat(match[1]) + 360) % 360;\n\t\tvar s = clamp(parseFloat(match[2]), 0, 100);\n\t\tvar l = clamp(parseFloat(match[3]), 0, 100);\n\t\tvar a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);\n\n\t\treturn [h, s, l, a];\n\t}\n\n\treturn null;\n};\n\ncs.get.hwb = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar hwb = /^hwb\\(\\s*([+-]?\\d*[\\.]?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\tvar match = string.match(hwb);\n\n\tif (match) {\n\t\tvar alpha = parseFloat(match[4]);\n\t\tvar h = ((parseFloat(match[1]) % 360) + 360) % 360;\n\t\tvar w = clamp(parseFloat(match[2]), 0, 100);\n\t\tvar b = clamp(parseFloat(match[3]), 0, 100);\n\t\tvar a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);\n\t\treturn [h, w, b, a];\n\t}\n\n\treturn null;\n};\n\ncs.to.hex = function () {\n\tvar rgba = swizzle(arguments);\n\n\treturn (\n\t\t'#' +\n\t\thexDouble(rgba[0]) +\n\t\thexDouble(rgba[1]) +\n\t\thexDouble(rgba[2]) +\n\t\t(rgba[3] < 1\n\t\t\t? (hexDouble(Math.round(rgba[3] * 255)))\n\t\t\t: '')\n\t);\n};\n\ncs.to.rgb = function () {\n\tvar rgba = swizzle(arguments);\n\n\treturn rgba.length < 4 || rgba[3] === 1\n\t\t? 'rgb(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ')'\n\t\t: 'rgba(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ', ' + rgba[3] + ')';\n};\n\ncs.to.rgb.percent = function () {\n\tvar rgba = swizzle(arguments);\n\n\tvar r = Math.round(rgba[0] / 255 * 100);\n\tvar g = Math.round(rgba[1] / 255 * 100);\n\tvar b = Math.round(rgba[2] / 255 * 100);\n\n\treturn rgba.length < 4 || rgba[3] === 1\n\t\t? 'rgb(' + r + '%, ' + g + '%, ' + b + '%)'\n\t\t: 'rgba(' + r + '%, ' + g + '%, ' + b + '%, ' + rgba[3] + ')';\n};\n\ncs.to.hsl = function () {\n\tvar hsla = swizzle(arguments);\n\treturn hsla.length < 4 || hsla[3] === 1\n\t\t? 'hsl(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%)'\n\t\t: 'hsla(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%, ' + hsla[3] + ')';\n};\n\n// hwb is a bit different than rgb(a) & hsl(a) since there is no alpha specific syntax\n// (hwb have alpha optional & 1 is default value)\ncs.to.hwb = function () {\n\tvar hwba = swizzle(arguments);\n\n\tvar a = '';\n\tif (hwba.length >= 4 && hwba[3] !== 1) {\n\t\ta = ', ' + hwba[3];\n\t}\n\n\treturn 'hwb(' + hwba[0] + ', ' + hwba[1] + '%, ' + hwba[2] + '%' + a + ')';\n};\n\ncs.to.keyword = function (rgb) {\n\treturn reverseNames[rgb.slice(0, 3)];\n};\n\n// helpers\nfunction clamp(num, min, max) {\n\treturn Math.min(Math.max(min, num), max);\n}\n\nfunction hexDouble(num) {\n\tvar str = num.toString(16).toUpperCase();\n\treturn (str.length < 2) ? '0' + str : str;\n}\n","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","'use strict';\n\nvar isArrayish = require('is-arrayish');\n\nvar concat = Array.prototype.concat;\nvar slice = Array.prototype.slice;\n\nvar swizzle = module.exports = function swizzle(args) {\n\tvar results = [];\n\n\tfor (var i = 0, len = args.length; i < len; i++) {\n\t\tvar arg = args[i];\n\n\t\tif (isArrayish(arg)) {\n\t\t\t// http://jsperf.com/javascript-array-concat-vs-push/98\n\t\t\tresults = concat.call(results, slice.call(arg));\n\t\t} else {\n\t\t\tresults.push(arg);\n\t\t}\n\t}\n\n\treturn results;\n};\n\nswizzle.wrap = function (fn) {\n\treturn function () {\n\t\treturn fn(swizzle(arguments));\n\t};\n};\n","module.exports = function isArrayish(obj) {\n\tif (!obj || typeof obj === 'string') {\n\t\treturn false;\n\t}\n\n\treturn obj instanceof Array || Array.isArray(obj) ||\n\t\t(obj.length >= 0 && (obj.splice instanceof Function ||\n\t\t\t(Object.getOwnPropertyDescriptor(obj, (obj.length - 1)) && obj.constructor.name !== 'String')));\n};\n","// parse options from input\r\n'use strict'\r\n\r\nvar boardColor = require('./board-color')\r\nvar xid = require('@tracespace/xml-id')\r\nvar xmlElementString = require('xml-element-string')\r\n\r\nmodule.exports = function parseOptions(input) {\r\n  if (typeof input === 'string') {\r\n    input = {id: input}\r\n  } else if (!input) {\r\n    input = {}\r\n  }\r\n\r\n  return {\r\n    id: xid.ensure(input.id),\r\n    color: boardColor.getColor(input.color),\r\n    attributes: input.attributes || {},\r\n    useOutline: input.useOutline != null ? input.useOutline : true,\r\n    createElement: input.createElement || xmlElementString,\r\n  }\r\n}\r\n","// xml id utilities\r\n'use strict'\r\n\r\n// subset of characters that are XML ID, CSS identifier, and URL friendly\r\nvar START_CHAR = '_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'\r\nvar CHAR = '-0123456789' + START_CHAR\r\nvar REPLACE_RE = new RegExp('^[^' + START_CHAR + ']|[^\\\\' + CHAR + ']', 'g')\r\n\r\nvar DEFAULT_RANDOM_LENGTH = 12\r\n\r\nmodule.exports = {\r\n  random: random,\r\n  sanitize: sanitize,\r\n  ensure: ensure,\r\n}\r\n\r\nfunction random(length) {\r\n  length = length || DEFAULT_RANDOM_LENGTH\r\n  return _getRandomString(1, START_CHAR) + _getRandomString(length - 1, CHAR)\r\n}\r\n\r\nfunction sanitize(source) {\r\n  return source.replace(REPLACE_RE, '_')\r\n}\r\n\r\nfunction ensure(maybeId, length) {\r\n  return typeof maybeId === 'string' ? sanitize(maybeId) : random(length)\r\n}\r\n\r\nfunction _getRandomString(length, alphabet) {\r\n  var abLength = alphabet.length\r\n  var result = ''\r\n\r\n  while (length > 0) {\r\n    length--\r\n    result += alphabet[Math.floor(Math.random() * abLength)]\r\n  }\r\n\r\n  return result\r\n}\r\n","// create an xml element string\n'use strict'\n\nvar escapeHtml = require('escape-html')\n\nmodule.exports = function createXmlString(tag, attributes, children) {\n  attributes = attributes || {}\n  children = children || []\n\n  var start = '<' + escapeHtml(tag)\n\n  var middle = Object.keys(attributes).reduce(function(result, key) {\n    var value = attributes[key]\n    var attr = (value != null)\n      ? (' ' + escapeHtml(key) + '=\"' + escapeHtml(value) + '\"')\n      : ''\n\n    return result + attr\n  }, '')\n\n  var end = (children.length)\n    ? '>' + children.join('') + '</' + tag + '>'\n    : '/>'\n\n  return start + middle + end\n}\n","/*!\n * escape-html\n * Copyright(c) 2012-2013 TJ Holowaychuk\n * Copyright(c) 2015 Andreas Lubbe\n * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module variables.\n * @private\n */\n\nvar matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = escapeHtml;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nfunction escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n\n  if (!match) {\n    return str;\n  }\n\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34: // \"\n        escape = '&quot;';\n        break;\n      case 38: // &\n        escape = '&amp;';\n        break;\n      case 39: // '\n        escape = '&#39;';\n        break;\n      case 60: // <\n        escape = '&lt;';\n        break;\n      case 62: // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n\n    lastIndex = index + 1;\n    html += escape;\n  }\n\n  return lastIndex !== index\n    ? html + str.substring(lastIndex, index)\n    : html;\n}\n","// sort layers array into top and bottom\r\n'use strict'\r\n\r\nvar wtg = require('whats-that-gerber')\r\n\r\nmodule.exports = function sortLayers(layers) {\r\n  return layers.filter(acceptLayer).reduce(assignLayer, {\r\n    top: [],\r\n    bottom: [],\r\n    drills: [],\r\n    outline: null,\r\n  })\r\n}\r\n\r\nfunction acceptLayer(layer) {\r\n  return (\r\n    layer != null &&\r\n    layer.type != null &&\r\n    layer.side != null &&\r\n    layer.converter != null &&\r\n    layer.converter.layer != null &&\r\n    layer.converter.layer.length\r\n  )\r\n}\r\n\r\nfunction assignLayer(result, layer) {\r\n  var type = layer.type\r\n  var side = layer.side\r\n\r\n  if (type === wtg.TYPE_DRILL) {\r\n    result.drills.push(layer)\r\n  } else if (type === wtg.TYPE_OUTLINE) {\r\n    result.outline = layer\r\n  } else {\r\n    if (side === wtg.SIDE_TOP) {\r\n      result.top.push(layer)\r\n    } else if (side === wtg.SIDE_BOTTOM) {\r\n      result.bottom.push(layer)\r\n    }\r\n  }\r\n\r\n  return result\r\n}\r\n","// stack layers function (where the magic happens)\r\n'use strict'\r\n\r\nvar viewbox = require('viewbox')\r\nvar wtg = require('whats-that-gerber')\r\n\r\nvar gatherLayers = require('./_gather-layers')\r\n\r\nmodule.exports = function(\r\n  element,\r\n  id,\r\n  side,\r\n  layers,\r\n  drills,\r\n  outline,\r\n  useOutline\r\n) {\r\n  var classPrefix = id + '_'\r\n  var idPrefix = id + '_' + side + '_'\r\n  var mechMaskId = idPrefix + 'mech-mask'\r\n\r\n  var layerProps = gatherLayers(\r\n    element,\r\n    idPrefix,\r\n    layers,\r\n    drills,\r\n    outline,\r\n    useOutline\r\n  )\r\n  var defs = layerProps.defs\r\n  var box = layerProps.box\r\n  var units = layerProps.units\r\n\r\n  layers = layerProps.layerIds\r\n  drills = layerProps.drillIds\r\n\r\n  defs.push(mechMask(element, mechMaskId, box, drills))\r\n\r\n  // build the layer starting with an fr4 rectangle the size of the viewbox\r\n  var layer = [createRect(element, box, 'currentColor', classPrefix + 'fr4')]\r\n  var cuLayerId = findLayerId(layers, wtg.TYPE_COPPER)\r\n  var smLayerId = findLayerId(layers, wtg.TYPE_SOLDERMASK)\r\n  var ssLayerId = findLayerId(layers, wtg.TYPE_SILKSCREEN)\r\n  var spLayerId = findLayerId(layers, wtg.TYPE_SOLDERPASTE)\r\n  var outLayerId = layerProps.outlineId\r\n\r\n  // add copper and copper finish\r\n  if (cuLayerId) {\r\n    var cfMaskId = idPrefix + 'cf-mask'\r\n    var cfMaskShape = smLayerId\r\n      ? [useLayer(element, smLayerId)]\r\n      : [createRect(element, box)]\r\n    var cfMaskGroupAttr = {fill: '#fff', stroke: '#fff'}\r\n    var cfMaskGroup = [element('g', cfMaskGroupAttr, cfMaskShape)]\r\n\r\n    defs.push(element('mask', {id: cfMaskId}, cfMaskGroup))\r\n    layer.push(useLayer(element, cuLayerId, classPrefix + 'cu'))\r\n    layer.push(useLayer(element, cuLayerId, classPrefix + 'cf', cfMaskId))\r\n  }\r\n\r\n  // add soldermask and silkscreen\r\n  // silkscreen will not be added if no soldermask, because that's how it works in RL\r\n  if (smLayerId) {\r\n    // solder mask is... a mask, so mask it\r\n    var smMaskId = idPrefix + 'sm-mask'\r\n    var smMaskShape = [\r\n      createRect(element, box, '#fff'),\r\n      useLayer(element, smLayerId),\r\n    ]\r\n    var smMaskGroupAtrr = {fill: '#000', stroke: '#000'}\r\n    var smMaskGroup = [element('g', smMaskGroupAtrr, smMaskShape)]\r\n\r\n    defs.push(element('mask', {id: smMaskId}, smMaskGroup))\r\n\r\n    // add the layer that gets masked\r\n    var smGroupAttr = {mask: 'url(#' + smMaskId + ')'}\r\n    var smGroupShape = [\r\n      createRect(element, box, 'currentColor', classPrefix + 'sm'),\r\n    ]\r\n\r\n    if (ssLayerId) {\r\n      smGroupShape.push(useLayer(element, ssLayerId, classPrefix + 'ss'))\r\n    }\r\n\r\n    layer.push(element('g', smGroupAttr, smGroupShape))\r\n  }\r\n\r\n  // add solderpaste\r\n  if (spLayerId) {\r\n    layer.push(useLayer(element, spLayerId, classPrefix + 'sp'))\r\n  }\r\n\r\n  // add board outline if necessary\r\n  if (outLayerId && !useOutline) {\r\n    layer.push(useLayer(element, outLayerId, classPrefix + 'out'))\r\n  }\r\n\r\n  return {\r\n    defs: defs,\r\n    layer: layer,\r\n    mechMaskId: mechMaskId,\r\n    outClipId: outLayerId && useOutline ? outLayerId : null,\r\n    box: box,\r\n    units: units,\r\n  }\r\n}\r\n\r\nfunction findLayerId(layers, type) {\r\n  var layer\r\n  var i\r\n\r\n  for (i = 0; i < layers.length; i++) {\r\n    layer = layers[i]\r\n    if (layer.type === type) {\r\n      return layer.id\r\n    }\r\n  }\r\n}\r\n\r\nfunction useLayer(element, id, className, mask) {\r\n  var attr = {'xlink:href': '#' + id}\r\n\r\n  if (className) {\r\n    attr.fill = 'currentColor'\r\n    attr.stroke = 'currentColor'\r\n    attr.class = className\r\n  }\r\n\r\n  if (mask) {\r\n    attr.mask = 'url(#' + mask + ')'\r\n  }\r\n\r\n  return element('use', attr)\r\n}\r\n\r\nfunction createRect(element, box, fill, className) {\r\n  var attr = viewbox.rect(box)\r\n\r\n  if (fill) {\r\n    attr.fill = fill\r\n  }\r\n\r\n  if (className) {\r\n    attr.class = className\r\n  }\r\n\r\n  return element('rect', attr)\r\n}\r\n\r\nfunction mechMask(element, id, box, drills) {\r\n  var children = drills.map(function(layer) {\r\n    return useLayer(element, layer.id)\r\n  })\r\n\r\n  children.unshift(createRect(element, box, '#fff'))\r\n\r\n  var groupAttr = {fill: '#000', stroke: '#000'}\r\n  var group = [element('g', groupAttr, children)]\r\n\r\n  return element('mask', {id: id}, group)\r\n}\r\n","// helper for stack layers that scales, wraps, gathers the defs of layers\r\n'use strict'\r\n\r\nvar viewbox = require('viewbox')\r\nvar wtg = require('whats-that-gerber')\r\n\r\nvar wrapLayer = require('./wrap-layer')\r\n\r\nmodule.exports = function gatherLayers(\r\n  element,\r\n  idPrefix,\r\n  layers,\r\n  drills,\r\n  outline,\r\n  useOutline\r\n) {\r\n  var defs = []\r\n  var layerIds = []\r\n  var drillIds = []\r\n  var units = ''\r\n  var unitsCount = {in: 0, mm: 0}\r\n  var allLayers = layers.concat(drills, outline || [])\r\n\r\n  var drillCount = 0\r\n  var getUniqueId = function(type) {\r\n    var id = idPrefix + type\r\n\r\n    if (type === wtg.TYPE_DRILL) {\r\n      drillCount++\r\n      id += drillCount\r\n    }\r\n\r\n    return id\r\n  }\r\n\r\n  allLayers.forEach(function(layer) {\r\n    if (!layer.externalId) {\r\n      defs = defs.concat(layer.converter.defs)\r\n    }\r\n\r\n    if (layer.converter.units === 'mm') {\r\n      unitsCount.mm++\r\n    } else {\r\n      unitsCount.in++\r\n    }\r\n  })\r\n\r\n  if (unitsCount.in + unitsCount.mm) {\r\n    units = unitsCount.in > unitsCount.mm ? 'in' : 'mm'\r\n  }\r\n\r\n  var viewboxLayers = useOutline && outline ? [outline] : allLayers\r\n\r\n  var box = viewboxLayers.reduce(function(result, layer) {\r\n    var layerBox = layer.converter.viewBox\r\n    var layerUnits = layer.converter.units\r\n\r\n    if (layerUnits && layerBox[2] !== 0 && layerBox[3] !== 0) {\r\n      return viewbox.add(\r\n        result,\r\n        viewbox.scale(layerBox, getScale(units, layerUnits))\r\n      )\r\n    }\r\n\r\n    return result\r\n  }, viewbox.create())\r\n\r\n  var wrapConverterLayer = function(collection) {\r\n    return function(layer) {\r\n      var id = layer.externalId\r\n      var converter = layer.converter\r\n\r\n      if (!id) {\r\n        id = getUniqueId(layer.type)\r\n        defs.push(\r\n          wrapLayer(element, id, converter, getScale(units, converter.units))\r\n        )\r\n      }\r\n\r\n      collection.push({type: layer.type, id: id})\r\n    }\r\n  }\r\n\r\n  layers.forEach(wrapConverterLayer(layerIds))\r\n  drills.forEach(wrapConverterLayer(drillIds))\r\n\r\n  var outlineId\r\n\r\n  // add the outline to defs if it's not defined externally or if we're using it to clip\r\n  if (outline) {\r\n    if (outline.externalId && !useOutline) {\r\n      outlineId = outline.externalId\r\n    } else {\r\n      outlineId = getUniqueId(outline.type)\r\n\r\n      defs.push(\r\n        wrapLayer(\r\n          element,\r\n          outlineId,\r\n          outline.converter,\r\n          getScale(units, outline.converter.units),\r\n          useOutline ? 'clipPath' : 'g'\r\n        )\r\n      )\r\n    }\r\n  }\r\n\r\n  return {\r\n    defs: defs,\r\n    box: box,\r\n    units: units,\r\n    layerIds: layerIds,\r\n    drillIds: drillIds,\r\n    outlineId: outlineId,\r\n  }\r\n}\r\n\r\nfunction getScale(units, layerUnits) {\r\n  var scale = units === 'in' ? 1 / 25.4 : 25.4\r\n  var result = units === layerUnits ? 1 : scale\r\n\r\n  return result\r\n}\r\n","// wrap a layer in a group given the layer's converter object\r\n'use strict'\r\n\r\nmodule.exports = function wrapLayer(element, id, converter, scale, tag) {\r\n  var layer = converter.layer\r\n  var attr = {id: id}\r\n\r\n  if (scale && scale !== 1) {\r\n    attr.transform = 'scale(' + scale + ',' + scale + ')'\r\n  }\r\n\r\n  return element(tag || 'g', attr, layer)\r\n}\r\n"],"sourceRoot":""}